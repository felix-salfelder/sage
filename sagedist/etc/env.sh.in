# this file is part of Sage
# (c) 2013 Felix Salfelder
# license: gplv3+
#

# this is the environment used before sagelib has been staged/built

# i'm not sure, but maybe SAGE_LOCAL might be $SAGE_DOT/local
# for standalone installs
SAGE_LOCAL="@abs_top_builddir@/local"

SAGE_ETC="$SAGE_LOCAL/etc"
SAGE_SHARE="$SAGE_LOCAL/share"
SAGE_SRC="@abs_top_srcdir@/src"

SAGE_DOC_SRC="$SAGE_SRC/doc"
SAGE_DOC="@abs_top_builddir@/src/doc"

SAGE_LOGS="$SAGE_LOCAL/logs/pkgs"
SAGE_SPKG_INST="$SAGE_LOCAL/var/lib/sage/installed"

# this is *not* SAGE_LOCAL
# used as foreign package prefix in environment files
# SAGE_PREFIX="@prefix@"
# export SAGE_PREFIX

@VPATH_BUILD_TRUE@PATH=@abs_srcdir@/../bin:$PATH
PATH=@abs_builddir@/../bin:$PATH
# PATH="$SAGE_LOCAL/bin:$PATH"

LD_LIBRARY_PATH="$SAGE_LOCAL/lib:$LD_LIBRARY_PATH"

# SAGE_ROOT? why?
export SAGE_LOCAL \
       SAGE_LOGS \
       SAGE_DOC \
       SAGE_ETC \
       SAGE_SHARE \
       SAGE_SPKG_INST \
       SAGE_SRC \
       PATH \
       LD_LIBRARY_PATH

# quick hack. this must eventually point to the GNU make verified by configure
export MAKE=make

# FIXME: cannot know yet?!
if [ -z "$FC" ]; then
    if [ -n "$SAGE_FORTRAN" ]; then
        # Deprecated, see #13349.
        FC="$SAGE_FORTRAN"
    elif command -v gfortran >/dev/null 2>/dev/null; then
        FC=gfortran
    elif command -v g95 >/dev/null 2>/dev/null; then
        FC=g95
    elif command -v g77 >/dev/null 2>/dev/null; then
        FC=g77
    fi
fi
export FC

# this is the prefix where we want foreign packages to be installed/staged
# this must be SAGE_LOCAL for backwards compatibility
export SAGE_PREFIX="$SAGE_LOCAL"

# this is where packages place extra environment
for i in $SAGE_LOCAL/etc/env.d/*.sh; do
	[ -f "$i" ] && source $i
done
