#!/usr/bin/env sage-dist-make

###########################################
PACKAGE_NAME=cython
PACKAGE_VERSION=0.19.1.p0
###########################################

# ugly, but works when called like old spkg-install
COMMONMK?=spkg.mk
include $(COMMONMK)

install: uninstall-hack patch-stamp
.PHONY: uninstall-hack

uninstall-hack:
	# Remove old copies of Cython
	rm -rf $(SAGE_LOCAL)/lib/python*/site-packages/Cython*

install: cython.sh
	cd src; $(SETUP_PY_INSTALL)
	$(SAGE_INSTALL) -d "$(DESTDIR)$(SAGE_ETC)/env.d"
	$(SAGE_INSTALL) -t "$(DESTDIR)$(SAGE_ETC)/env.d" cython.sh

# quick hack, use actual python dir...
cython.sh: .
	echo '[ -n "$$PYTHONPATH" ] && PYTHONPATH=":$$PYTHONPATH"' > $@
	echo 'PYTHONPATH="$(SAGE_LOCAL)/lib/python2.7/site-packages$$PYTHONPATH"' >> $@
	echo 'export PYTHONPATH' >> $@
